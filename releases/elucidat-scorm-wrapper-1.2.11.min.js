var Debug_API=function(){};Debug_API.prototype.Initialize=function(){return console.log(" └ Debug_api:Initialize"),!0},Debug_API.prototype.Terminate=function(){return console.log(" └ Debug_api:Terminate"),!0},Debug_API.prototype.GetValue=function(e){return""},Debug_API.prototype.SetValue=function(e,t){return console.log(" ┌ Debug_api:SetValue: "+e+"="+t),""},Debug_API.prototype.Commit=function(){return console.log(" └ Debug_api:Commit"),!0},Debug_API.prototype.GetLastError=function(){return 0},Debug_API.prototype.GetErrorString=function(e){return""},Debug_API.prototype.GetDiagnostic=function(e){return""},Debug_API.prototype.LMSInitialize=function(){return console.log(" └ Debug_api:LMSInitialize"),!0},Debug_API.prototype.LMSFinish=function(){return console.log(" └ Debug_api:LMSFinish"),!0},Debug_API.prototype.LMSGetValue=function(e){return""},Debug_API.prototype.LMSSetValue=function(e,t){return console.log(" ┌ Debug_api:LMSSetValue: "+e+"="+t),""},Debug_API.prototype.LMSCommit=function(){return console.log(" └ Debug_api:Commit"),!0},Debug_API.prototype.LMSGetLastError=function(){return 0},Debug_API.prototype.LMSGetErrorString=function(e){return""},Debug_API.prototype.LMSGetDiagnostic=function(e){return""};var Scorm=function(e){this.options=$.extend({},{debug_mode:"2004"},e),this.scorm_interface=null,this.mode=null,this.active=!1,this.objectives=[],this.interactions=[],this.start_time=new Date().getTime(),this.has_score=!1,this.is_debug=!1,this._search_for_api(window),null==this.scorm_interface?(this.mode=this.options.debug_mode,this.is_debug=!0,console.log("LMS not present - Created SCORM "+this.mode+" Debug interface."),this.scorm_interface=new Debug_API):("LMSCommit"in this.scorm_interface?this.mode="1.2":this.mode="2004",console.log("Found SCORM "+this.mode+" interface."))};Scorm.prototype._format_time=function(e){function t(e,t){var i="0000"+new String(Math.round(e));return i.substr(i.length-t)}var i=Math.floor((e/=1e3)/3600),o=Math.floor((e-=3600*i)/60),e=e-60*o;return"2004"==this.mode?"PT"+(i?i+"H":"")+(o?o+"M":"")+Math.round(e)+"S":t(i,2)+":"+t(o,2)+":"+t(e,2)},Scorm.prototype._search_for_api=function(e){try{for(;null!=e&&null==this.scorm_interface;)e.API?this.scorm_interface=e.API:e.API_1484_11&&(this.scorm_interface=e.API_1484_11),null==e.opener||e.opener.closed||this._search_for_api(e.opener),e=e==e.parent?null:e.parent}catch(t){return null}},Scorm.prototype.Check=function(){var e=0,t="";if("2004"==this.mode){if(e=parseInt(this.scorm_interface.GetLastError())){console.log("Scorm:Check - Found error code: "+e);try{t="Error ("+e+"): "+this.scorm_interface.GetErrorString(e)}catch(i){console.error("There was a problem getting the error from the LMS",i)}}}else if("1.2"==this.mode&&(e=parseInt(this.scorm_interface.LMSGetLastError()))){console.log("Scorm:Check - Found error code: "+e);try{t="Error ("+e+"): "+this.scorm_interface.LMSGetErrorString(e)}catch(o){console.error("There was a problem getting the error from the LMS",o)}}return{code:e,description:t}},Scorm.prototype.Initialize=function(){console.log("Scorm:Initialize"),"2004"==this.mode?this.scorm_interface.Initialize(""):"1.2"==this.mode&&this.scorm_interface.LMSInitialize(""),0==this.Check().code&&(this.active=!0);var e=this.GetCompletionStatus();return e&&"not attempted"!=e&&"unknown"!=e||(this.SetIncomplete(),this.SetExit("suspend")),this.active},Scorm.prototype.Terminate=function(){console.log("Scorm:Terminate"),"2004"==this.mode?this.scorm_interface.Terminate(""):"1.2"==this.mode&&this.scorm_interface.LMSFinish(""),0==this.Check().code&&(this.active=!1)},Scorm.prototype.Deactivate=function(){console.log("Scorm:Deactivate"),this.active=!1},Scorm.prototype.SetValue=function(e,t,i){if(this.active){"2004"==this.mode?(this.scorm_interface.SetValue(e,t),i||(o=this.scorm_interface.GetValue(e))):"1.2"!=this.mode||(this.scorm_interface.LMSSetValue(e,t),i||(o=this.scorm_interface.LMSGetValue(e))),top.postMessage&&top.postMessage(e+"="+t,"*");var o,r=this.Check(),s="Scorm:SetValue: "+e+"="+t;if(i||(s+="? "+(r.code?r.description:"Echo:"+o)),r.code&&0!==r.code)try{window.dispatchEvent(new CustomEvent("REPORT_ERROR",{detail:{error:"Scorm Error",type:"SCORM",code:r.code,description:r.description,key:e,value:t}}))}catch(n){console.warn("Error reporting error: "+n)}return console.log(s),r.code}},Scorm.prototype.GetValue=function(e){if(this.active){var t;return"2004"==this.mode?t=this.scorm_interface.GetValue(e):"1.2"==this.mode&&(t=this.scorm_interface.LMSGetValue(e)),console.log("Scorm:GetValue: "+e+"="+t),t}},Scorm.prototype.Commit=function(){return(console.log("Scorm:Commit"),"2004"==this.mode)?this.scorm_interface.Commit(""):"1.2"==this.mode?this.scorm_interface.LMSCommit(""):void 0},Scorm.prototype.GetLearnerName=function(){return"2004"==this.mode?this.GetValue("cmi.learner_name"):"1.2"==this.mode?this.GetValue("cmi.core.student_name"):void 0},Scorm.prototype.GetLearnerID=function(){return"2004"==this.mode?this.GetValue("cmi.learner_id"):"1.2"==this.mode?this.GetValue("cmi.core.student_id"):void 0},Scorm.prototype.GetLocation=function(){return"2004"==this.mode?this.GetValue("cmi.location"):"1.2"==this.mode?this.GetValue("cmi.core.lesson_location"):void 0},Scorm.prototype.SetLocation=function(e){return"2004"==this.mode?this.SetValue("cmi.location",e):"1.2"==this.mode?this.SetValue("cmi.core.lesson_location",e):void 0},Scorm.prototype.GetExit=function(){return"2004"==this.mode?this.GetValue("cmi.exit"):"1.2"==this.mode?this.GetValue("cmi.core.exit"):void 0},Scorm.prototype.SetExit=function(e){return"2004"==this.mode?this.SetValue("cmi.exit",e):"1.2"==this.mode?this.SetValue("cmi.core.exit",e):void 0},Scorm.prototype.GetSuspendData=function(){return this.GetValue("cmi.suspend_data")},Scorm.prototype.SetSuspendData=function(e){this.SetValue("cmi.suspend_data",e),this.Commit()},Scorm.prototype.GetProgress=function(){if("2004"==this.mode)return this.GetValue("cmi.progress_measure")},Scorm.prototype.SetProgress=function(e){if("2004"==this.mode)return this.SetValue("cmi.progress_measure",e)},Scorm.prototype.GetCompletionThreshold=function(){return"2004"==this.mode&&this.GetValue("cmi.completion_threshold")},Scorm.prototype.SetCompletionThreshold=function(e){"2004"==this.mode&&this.SetValue("cmi.completion_threshold",e)},Scorm.prototype.GetScoreThreshold=function(){return"2004"==this.mode&&this.GetValue("cmi.progress_measure")},Scorm.prototype.SetScoreThreshold=function(e){"2004"==this.mode&&this.SetValue("cmi.scaled_passing_score",e)},Scorm.prototype.SetSessionTime=function(e){return(e||(e=new Date().getTime()-this.start_time),"2004"==this.mode)?this.SetValue("cmi.session_time",this._format_time(e),!0):"1.2"==this.mode?this.SetValue("cmi.core.session_time",this._format_time(e),!0):void 0},Scorm.prototype.GetTotalTime=function(){return"2004"==this.mode?this.GetValue("cmi.total_time"):"1.2"==this.mode&&this.GetValue("cmi.core.total_time")},Scorm.prototype.GetCompletionStatus=function(){if("2004"==this.mode)return this.GetValue("cmi.completion_status");if("1.2"==this.mode){var e=this.GetValue("cmi.core.lesson_status");return"passed"==e||"failed"==e?"completed":e}},Scorm.prototype.SetCompletionStatus=function(e){"2004"==this.mode?this.SetValue("cmi.completion_status",e):"1.2"==this.mode&&this.SetValue("cmi.core.lesson_status",e),this.Commit()},Scorm.prototype.GetResult=function(){if("2004"==this.mode)return this.GetValue("cmi.success_status");if("1.2"==this.mode){var e=this.GetValue("cmi.core.lesson_status");return"passed"==e||"failed"==e?e:"unknown"}},Scorm.prototype.SetResult=function(e){"2004"==this.mode?"passed"==e?this.SetValue("cmi.success_status","passed"):"failed"==e&&this.SetValue("cmi.success_status","failed"):"1.2"==this.mode&&("passed"==e?this.SetCompletionStatus("passed"):"failed"==e&&this.SetCompletionStatus("failed")),this.Commit()},Scorm.prototype.SetPassed=function(){this.SetResult("passed")},Scorm.prototype.SetFailed=function(){this.SetResult("failed")},Scorm.prototype.SetCompleted=function(){this.SetCompletionStatus("completed")},Scorm.prototype.SetIncomplete=function(){this.SetCompletionStatus("incomplete")},Scorm.prototype.SetScore=function(e,t,i){this.has_score=!0,"2004"==this.mode?(this.SetValue("cmi.score.raw",e),this.SetValue("cmi.score.scaled",1/i*e),this.SetValue("cmi.score.min",t),this.SetValue("cmi.score.max",i)):"1.2"==this.mode&&(this.SetValue("cmi.core.score.raw",e),this.SetValue("cmi.core.score.min",t),this.SetValue("cmi.core.score.max",i)),this.Commit()},Scorm.prototype.SetObjective=function(e,t,i,o,r,s){var n=this.objectives.indexOf(e);-1==n&&(n=this.objectives.length,this.SetValue("cmi.objectives."+n+".id",e),"2004"==this.mode&&this.SetValue("cmi.objectives."+n+".description",s),this.objectives.push(e),this.SetValue("cmi.objectives."+n+".score.min",o||0),this.SetValue("cmi.objectives."+n+".score.max",r||100)),this.SetValue("cmi.objectives."+n+".score.raw",i||0),"2004"==this.mode?(this.SetValue("cmi.objectives."+n+".completion_status","completed"),("passed"==t||"failed"==t)&&this.SetValue("cmi.objectives."+n+".success_status",t)):"passed"==t||"failed"==t?this.SetValue("cmi.objectives."+n+".status",t):this.SetValue("cmi.objectives."+n+".status","completed")},Scorm.prototype.SetInteraction=function(e,t,i,o,r,s,n,c){var a=this.interactions.indexOf(e),m="1.2"==this.mode;if(-1==a&&(a=this.interactions.length,this.SetValue("cmi.interactions."+a+".id",e,m),this.SetValue("cmi.interactions."+a+".objectives.0.id",t,m),"2004"==this.mode&&(this.SetValue("cmi.interactions."+a+".description",r),this.SetValue("cmi.interactions."+a+".type",s)),this.interactions.push(e)),o){if("2004"==this.mode){if(s&&n){if(this.SetValue("cmi.interactions."+a+".learner_response",o),this.GetValue("cmi.interactions."+a+".learner_response")!=o&&(this.SetValue("cmi.interactions."+a+".learner_response","elucidaterror"),this.SetValue("cmi.interactions."+a+".learner_response",o),this.GetValue("cmi.interactions."+a+".learner_response")!=o)){var u=o.split("[,]").join("__");this.SetValue("cmi.interactions."+a+".learner_response",u)}this.SetValue("cmi.interactions."+a+".correct_responses.0.pattern",n),this.SetValue("cmi.interactions."+a+".weighting",c)}}else this.SetValue("cmi.interactions."+a+".student_response",o,m)}"neutral"==i?this.SetValue("cmi.interactions."+a+".result","neutral",m):"passed"==i||"completed"==i?this.SetValue("cmi.interactions."+a+".result","correct",m):"failed"==i&&("2004"==this.mode?this.SetValue("cmi.interactions."+a+".result","incorrect"):this.SetValue("cmi.interactions."+a+".result","wrong",m))},Scorm.prototype.GetLanguage=function(){var e=null;return"2004"==this.mode?e=this.GetValue("cmi.learner_preference.language"):"1.2"==this.mode&&(e=this.GetValue("cmi.student_preference.language")),e&&(e=e.toLowerCase().trim()),e},Scorm.prototype.SetLanguage=function(e){return"2004"==this.mode?this.SetValue("cmi.learner_preference.language",e):"1.2"==this.mode?this.SetValue("cmi.student_preference.language",e):void 0};